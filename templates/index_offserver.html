<!DOCTYPE html>
<html lang="en" >
<head>
    <meta charset="UTF-8">
    <link rel='stylesheet' href='https://fonts.googleapis.com/css?family=Roboto:100,300,400,500,700,900|Material+Icons'>
    <link rel='stylesheet' href='https://cdn.jsdelivr.net/npm/quasar@1.13.2/dist/quasar.min.css'>
</head>
<body translate="no" >

    <h5>Flask-SocketIO Test</h5>
    <p>Async mode is: <b>{{ async_mode }}</b></p>
    <p>Average ping/pong latency: <b><span id="ping-pong"></span>ms</b></p>
    <h6>Send:</h6>

    <form id="emit" method="POST" action='#'>
        <input type="text" name="emit_data" id="emit_data" placeholder="Message">
        <input type="submit" value="Echo">
    </form>

    <div id="q-app">
        <!-- <button onclick="myFct()"> allo </button> -->

        <div class="q-pa-md q-gutter-sm">
            <q-btn color="white" text-color="black" label="Standard " @click="ioObj.show=!ioObj.show"></q-btn>
            <q-btn color="black" :label="ioObj.lab" v-if="ioObj.show" ></q-btn>
        </div>
    </div>


    <h6>Receive:</h6>
    <div id="log"></div>

<script src='https://cdn.jsdelivr.net/npm/vue/dist/vue.js'></script>
<script src='https://cdn.jsdelivr.net/npm/quasar@1.13.2/dist/quasar.umd.min.js'></script>
<script src="https://code.jquery.com/jquery-1.12.4.min.js" ></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/socket.io/2.2.0/socket.io.js" ></script>
<script>
    $(document).ready(function() {
        namespace = '/test';
        var socket = io(namespace);

        socket.on('connect', function() {
            socket.emit('my_event', {data: 'I\'m connected!'});
        });

        socket.on('my_response', function(msg, cb) {
            $('#log').append('<br>' + $('<div/>').text('Received #' + msg.count + ': ' + msg.data).html());
            if (cb)
                cb();
        });

        $('form#emit').submit(function(event) {
            socket.emit('my_event', {data: $('#emit_data').val()});
            return false;
        });

    })

    // need to declare io with keys ts, tk, rs, rk
    ioObj = {
        _triggers: [],
        _senders: [],

        show: true,
        lab: 'black button'
    };


    // this can be anything
    function myFct() {
        console.log('a');
        ioObj.show = true;
    }


    // this to be in a separate asset JS file
    pyVue = new Vue({
        el: '#q-app',
        delimiters: ['(|', '|)'],

        data() {
            return {
                ioObj: ioObj
            };

        }
    });

</script>
</body>
</html>

